<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Registro Pesaje Manzana</title>
<style>
body { font-family: Arial; text-align: center; background:#f2f2f2; }
.container { margin-top:40px; }
input, select {
  font-size:20px;
  padding:10px;
  margin:10px;
  width:250px;
}
#guardar {
  background:green;
  color:white;
  width:250px;
  height:70px;
  font-size:24px;
}
</style>
</head>

<body>
<div class="container">
<h2>Registro Pesaje üçé</h2>

<input type="text" id="usuario" placeholder="Nombre Operador"><br>

<select id="exportadora">
  <option value="">Seleccionar Exportadora</option>
  <option>Fruclem</option>
  <option>JHB</option>
  <option>Talamaya</option>
</select>

<select id="salida">
  <option value="">Seleccionar Salida</option>
</select><br>

<input type="text" id="calibre" placeholder="Ingresar Calibre"><br>

<select id="categoria">
  <option value="">Seleccionar Categor√≠a</option>
  <option>Premium</option>
  <option>Extra</option>
  <option>Fancy</option>
  <option>Choice</option>
  <option>Granel</option>
</select><br>

<input type="number" id="peso" placeholder="Peso (kg)" step="0.01"><br>

<button id="guardar" onclick="guardar()">GUARDAR</button>

<p id="mensaje"></p>
</div>

<script>

// Generar salidas 1 a 41 autom√°ticamente
for(let i=1; i<=41; i++){
  let option = document.createElement("option");
  option.text = i;
  option.value = i;
  document.getElementById("salida").add(option);
}

function guardar(){
  var usuario = document.getElementById("usuario").value.trim();
  var exportadora = document.getElementById("exportadora").value;
  var salida = document.getElementById("salida").value;
  var calibre = document.getElementById("calibre").value.trim();
  var categoria = document.getElementById("categoria").value;
  var peso = document.getElementById("peso").value;

  if(!usuario || !exportadora || !salida || !calibre || !categoria || !peso){
    alert("Complete todos los campos");
    return;
  }

  fetch("https://script.google.com/macros/s/AKfycbyesPG5gRI33o-4Lq3I_-Q0DYqTdvofUFbzjFBOp7PiiBafP9yAZmOgWLdPhruumWjf/exec", {
    method: "POST",
    body: JSON.stringify({
      usuario: usuario,
      exportadora: exportadora,
      salida: salida,
      calibre: calibre,
      categoria: categoria,
      peso: peso
    })
  })
  .then(res => res.text())
  .then(data => {
    document.getElementById("mensaje").innerHTML = "Registro Guardado ‚úÖ";
    document.getElementById("calibre").value = "";
    document.getElementById("peso").value = "";
  })
  .catch(error => {
    document.getElementById("mensaje").innerHTML = "Error al guardar ‚ùå";
  });
}
</script>

</body>
</html>
